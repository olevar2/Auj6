# Linux Deployment Configuration for AUJ Platform
# Optimized for Linux production deployment with MetaApi
# Clean, production-ready configuration

# Platform Configuration
deployment:
  platform: "linux"
  mode: "production"
  version: "2.0.0"

# Data Providers - MetaApi Primary
data_providers:
  primary: "metaapi"
  fallback: "yahoo_finance"
  
  metaapi:
    priority: "PRIMARY"
    enabled: true
    connection_mode: "cloud"
  
  # Legacy providers disabled
  mt5:
    enabled: false
    deprecated: true
    migration_complete: true

# System Requirements
system_requirements:
  minimum:
    memory_gb: 2
    cpu_cores: 2
    disk_space_gb: 10
  
  recommended:
    memory_gb: 4
    cpu_cores: 4
    disk_space_gb: 50
  
  production:
    memory_gb: 8
    cpu_cores: 8
    disk_space_gb: 200

# Performance Optimization
performance:
  # Data streaming - optimized for Linux
  streaming_interval: 0.5
  cache_duration_minutes: 10
  max_concurrent_requests: 20
  
  # Connection pooling
  enable_connection_pooling: true
  max_connections: 10
  connection_idle_timeout: 300
  
  # Kernel parameters for high performance
  kernel_params:
    - "net.core.somaxconn=65535"
    - "net.ipv4.tcp_max_syn_backlog=65535"
    - "vm.swappiness=10"
    - "fs.file-max=100000"

# Service Configuration
services:
  auj_platform:
    name: "auj-platform"
    user: "auj"
    group: "auj"
    working_directory: "/opt/auj-platform"
    auto_start: true
    auto_restart: true
    restart_policy: "always"
    
    # Resource limits
    memory_limit: "2G"
    cpu_limit: "2.0"
    
    # Logging
    log_file: "/var/log/auj-platform/main.log"
    error_log: "/var/log/auj-platform/error.log"
    log_rotation: "daily"
    log_retention_days: 30

# Network Configuration
network:
  firewall:
    enabled: true
    allowed_ports:
      - 22    # SSH
      - 80    # HTTP
      - 443   # HTTPS
  
  ssl:
    enabled: true
    letsencrypt:
      enabled: true
      auto_renewal: true

# File System
filesystem:
  directories:
    base: "/opt/auj-platform"
    data: "/opt/auj-platform/data"
    logs: "/var/log/auj-platform"
    config: "/etc/auj-platform"
    cache: "/var/cache/auj-platform"
    backups: "/opt/auj-platform/backups"
  
  permissions:
    user: "auj"
    group: "auj"
    mode_directories: "0755"
    mode_files: "0644"
    mode_config: "0600"

# Environment Variables
environment:
  # MetaApi
  AUJ_METAAPI_TOKEN: "${METAAPI_TOKEN}"
  AUJ_METAAPI_ACCOUNT_ID: "${METAAPI_ACCOUNT_ID}"
  
  # Database
  AUJ_DB_URL: "sqlite:///opt/auj-platform/data/auj_platform.db"
  AUJ_DB_POOL_SIZE: "10"
  
  # Redis
  AUJ_REDIS_URL: "redis://localhost:6379/0"
  
  # Application
  AUJ_CONFIG_PATH: "/etc/auj-platform/main_config.yaml"
  AUJ_LOG_LEVEL: "INFO"
  AUJ_DEBUG_MODE: "false"
  AUJ_DEMO_MODE: "true"
  
  # Platform
  AUJ_PLATFORM: "linux"
  AUJ_DEPLOYMENT_ENV: "production"

# Security
security:
  users:
    - name: "auj"
      groups: ["auj"]
      shell: "/bin/bash"
      sudo_access: false
  
  ssh:
    enabled: true
    port: 22
    password_authentication: false
    key_authentication: true
    root_login: false
  
  audit:
    enabled: true
    log_file: "/var/log/audit/auj-platform.log"

# Backup Configuration
backup:
  database:
    enabled: true
    schedule: "0 2 * * *"  # Daily at 2 AM
    retention_days: 30
    compression: true
    encryption: true
  
  configuration:
    enabled: true
    schedule: "0 3 * * 0"  # Weekly Sunday 3 AM
    retention_weeks: 4

# Monitoring
monitoring:
  application:
    enabled: true
    metrics_endpoint: "http://localhost:8000/metrics"
    health_endpoint: "http://localhost:8000/health"
  
  alerts:
    enabled: true
    notification_channels:
      - email: "alerts@auj-platform.com"

# Maintenance
maintenance:
  auto_updates:
    enabled: true
    security_updates_only: true
    schedule: "0 6 * * 1"  # Monday 6 AM
  
  health_checks:
    enabled: true
    interval: 300  # 5 minutes
    timeout: 30
    retries: 3

# Dependencies
dependencies:
  python_packages:
    - "metaapi-cloud-sdk>=27.0.0"
    - "websockets>=11.0.0"
    - "aiohttp>=3.8.0"
    - "pandas>=2.0.0"
    - "numpy>=1.24.0"
    - "scipy>=1.10.0"
    - "scikit-learn>=1.3.0"
    - "ta-lib>=0.4.0"
    - "sqlalchemy>=2.0.0"
    - "pyyaml>=6.0"
    - "python-dotenv>=1.0.0"
